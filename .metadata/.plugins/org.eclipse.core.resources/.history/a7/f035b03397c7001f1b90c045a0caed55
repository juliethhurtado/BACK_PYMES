package co.edu.unicauca.sgph.reservatemporal.infrastructure.mapper;

import java.util.stream.Collectors;

import org.springframework.data.domain.Page;
import org.springframework.stereotype.Component;

import co.edu.unicauca.sgph.reservatemporal.domain.model.ReservaTemporal;
import co.edu.unicauca.sgph.reservatemporal.infrastructure.input.DTORequest.ReservaTemporalInDTO;
import co.edu.unicauca.sgph.reservatemporal.infrastructure.output.persistence.entity.ReservaTemporalEntity;

@Component
public class ReservaTemporalRestMapper {

    public ReservaTemporal toReservaTemporal(ReservaTemporalEntity entity) {
        if (entity == null) {
            return null;
        }

        ReservaTemporal reserva = new ReservaTemporal();

        // Mapeo de campos simples
        reserva.setIdentificacion(entity.getNumeroIdentificacion());
        reserva.setIdEspacioFisico(entity.getEspacioFisico() != null ? entity.getEspacioFisico().getIdEspacioFisico() : null);
        reserva.setIdUbicacion(entity.getEspacioFisico() != null && entity.getEspacioFisico().getUbicacion() != null
                ? entity.getEspacioFisico().getUbicacion().getIdUbicacion()
                : 0L); // Valor por defecto si es nulo
        reserva.setSalon(entity.getEspacioFisico() != null ? entity.getEspacioFisico().getSalon() : null);
        reserva.setEstado(entity.getEstado() != null ? entity.getEstado().getDescripcion().toString() : null);

        // Otros campos
        reserva.setUsuario(entity.getUsuario());
        reserva.setFechaReserva(entity.getFechaReserva());
        reserva.setHoraInicio(entity.getHoraInicio());
        reserva.setHoraFin(entity.getHoraFin());
        reserva.setObservaciones(entity.getObservaciones());

        return reserva;
    }

    public ReservaTemporalInDTO toReservaTemporalInDTO(ReservaTemporal reservaTemporal) {
        if (reservaTemporal == null) {
            return null;
        }

        ReservaTemporalInDTO dto = new ReservaTemporalInDTO();
        dto.setIdentificacion(reservaTemporal.getIdentificacion());
        dto.setIdEspacioFisico(reservaTemporal.getIdEspacioFisico());
        dto.setIdUbicacion(reservaTemporal.getIdUbicacion());
        dto.setSalon(reservaTemporal.getSalon());
        dto.setEstado(reservaTemporal.getEstado());
        dto.setUsuario(reservaTemporal.getUsuario());
        dto.setFechaReserva(reservaTemporal.getFechaReserva());
        dto.setHoraInicio(reservaTemporal.getHoraInicio());
        dto.setHoraFin(reservaTemporal.getHoraFin());
        dto.setObservaciones(reservaTemporal.getObservaciones());

        return dto;
    }

    public Page<ReservaTemporalInDTO> toPageReservaTemporalInDTO(Page<ReservaTemporal> reservas) {
        return reservas.map(this::toReservaTemporalInDTO);
    }
}
